name: Check capitalization

on:
  pull_request:
    branches: [main]

jobs:
  tablint:
    runs-on: ubuntu-latest
    name: Check capitalization
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Find wrong caps
        run: |
          pwd
          ls
          ls .github
          ERRORS=0
          echo "Reading array"
          read -a WORDS -d EOF < words.txt
          echo "Starting first for loop"
          for file in $(git grep -Il '' | grep tex$)
          do
            echo "Checking file $file"
            for word in ${WORDS[@]}
            do
              echo "Checking $word in $file"
              if grep -qP "\s$word" $file; then
                echo ""
                echo "Found $word instead of ${word^} in $file:"
                grep -nHP "\s$word" $file
                ERRORS=1
              fi
            done
          done


          if [[ $ERRORS == 1 ]]; then
            echo "Some words are not capitalized correctly. Please fix them."
            exit 1
          fi
